<!DOCTYPE html>
<html>
  <head>
    <title>Explorer - freehold</title>
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
		<link href="/core/v1/file/css/freehold.css" rel="stylesheet" media="screen"> 
		<link href="/core/v1/file/css/font-awesome.min.css" rel="stylesheet" media="screen"> 
		<link href="/explorer/v1/file/css/index.css" rel="stylesheet" media="screen"> 
	</head>
<body>
<div id="nb"></div>
<div id="pageContainer">
</div>
	
<!--templates-->
<script id="tNav" type="text/ractive">
<navbar error="{{error}}" app="Explorer"></navbar>
</script>

<script id="tMain" type="text/ractive">
<modal id="properties" title="{{currentFile.name}}" >
	TODO
</modal>

<modal id="settings" title="Explorer Settings" >
</modal>

<modal id="newFolder" title="New Folder" customFooter="true">
	<form class="form-horizontal" role="form" on-submit="newFolderSave">
		<div class="form-group">
			<label for="folderName" class="col-sm-3 control-label">Folder</label>
			<div class="col-sm-9">
				<input type="text" class="form-control" id="folderName" placeholder="Enter a folder name" value="{{newFolderName}}">
			</div>
		</div>
	</form>
	<div class="modal-footer">
		<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
		<button type="button" class="btn btn-primary" on-click="newFolderSave">Save</button>
	</div>
</modal>

<div id="pageNav" class="row">
	<div id="rootNav" class="col-sm-3">
		<div class="btn-group">
			<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
				{{#if app}}
					{{app}}
				{{else}} 
					<span class="glyphicon glyphicon-hdd"></span> Root
				{{/if}}
				<span class="caret"></span>
			</button>
			<ul class="dropdown-menu" role="menu">
				<li><a href="#" on-click="selectApp"><span class="glyphicon glyphicon-hdd"></span> Root</a></li>
				<li class="divider"></li>
				{{#apps:i}}
					<li><a href="#" on-click="selectApp">{{name}}</a></li>
				{{/apps}}
			</ul>
		</div>
		<button type="button" class="btn btn-sm btn-success pull-right" on-click ="newFolder">
			<span class="glyphicon glyphicon-plus"></span> New Folder</button>
	</div>
	<div id="folderNav" class="col-sm-7">
		{{#if selectKeypath !== "stars"}}
		<ol class="breadcrumb">
			{{#breadcrumbs:i}}
				<li><a href="#" on-click="crumbSelect">{{file.name}}</a></li>
			{{/breadcrumbs}}
			{{#currentFolder}}
			<li class="active">
				<span class="breadcrumb-menu dropdown">
				<a id="folderDrop" href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" role="button" aria-expanded="false">
				{{name}} <span class="caret"></span>
				</a>
				<ul class="dropdown-menu" role="menu" aria-labelledby="folderDrop">
					{{#if selectKeypath.indexOf("files") > -1}}
					<li>
						<a href="#" on-click="newFolder"><span class="glyphicon glyphicon-plus"></span> New Folder</a> 
					</li>
					<li class="divider"></li>
					{{/if}}
					<li>
						<a href="#" on-click="star">
							<span class="glyphicon glyphicon-star"></span> {{#if currentFolder.starred}}Remove{{else}}Add{{/if}} Star
						</a> 
					</li>
					{{#if selectKeypath.indexOf("files") > -1 && selectKeypath !== "files"}}
						<li><a href="#" on-click="renameFolder">Rename</a></li>
						<li><a href="#" on-click="deleteFolder"><span class="glyphicon glyphicon-trash"></span> Delete</a></li>
						<li class="divider"></li>
						<li><a href="#" on-click="properties"><span class="glyphicon glyphicon-cog"></span> Folder Properties</a></li>
					{{/if}}
				</ul>
				</span>
			</li>
			{{/currentFolder}}
		</ol>
		{{/if}}
	</div> <!-- folderNav -->
	<div  class="col-sm-2">
		<div class="pull-right">
		{{#if !listView}}
			<button type="button" class="btn btn-default" on-click="changeView" title="List View"><span class="fa fa-2 fa-list"></span></button>
		{{else}}
			<button type="button" class="btn btn-default" on-click="changeView" title="Grid View"><span class="fa fa-th"></span></button>
		{{/if}}
		<button type="button" class="btn btn-default" title="Settings"><span class="fa fa-2 fa-cogs"></span></button>
		</div>
	</div>

</div> <!-- row -->
<div class="row">
	<div id="sidebar" class="col-sm-3">
		<div id="trees">
			<tree root="{{files}}" on-select="fileTreeSelect" selectKeypath="{{selectKeypath.replace('files', 'root')}}">
			</tree>
			<tree root="{{datastores}}" on-select="dsTreeSelect" selectKeypath="{{selectKeypath.replace('datastores', 'root')}}" dsTree="true">
			</tree>
			<tree root="{{stars}}" on-select="viewStarred" selectKeypath="{{selectKeypath.replace('stars', 'root')}}">
			</tree>
		</div>
	</div> <!-- sidebar -->

	<div id="explorer" class="col-sm-9">
	{{#if !listView}}
		{{#currentFolder.children:i}}
			{{>fileTile}}
		{{/currentFolder.children}}
	{{else}}
	<!--gridview-->
	<table class="table table-condensed table-striped table-hover">
		<thead>
			<tr>
				<th>Name</th>
				<th>Owner</th>
				<th>Last Modified</th>
				<th>Size</th>
				<th></th>
			</tr>
		</thead>
		<tbody>
			{{#currentFolder.children:i}}
			<tr>
					{{#if .isFolder}}
					<td>
						<a href="#" on-click="explorerSelect">
							<span class="explorer-icon fa fa-{{explorerIcon}}"></span>  {{name}}
						</a>
				</td>
					{{else}}
				<td>
						<a href="{{url}}">
							<span class="explorer-icon fa fa-{{explorerIcon}}"></span>  {{name}}
						</a>
				</td>
					{{/if}}
				<td>{{permissions.owner}}</td>
				<td>{{modifiedDate}}</td>
				<td>{{humanSize}}</td>
				<td>
				{{#if selectKeypath !== "stars"}}
					{{^.isFolder}}
					<button type="button" class="btn btn-xs btn-default pull-right" title="Properties">
						<span class="glyphicon glyphicon-cog"></span></button>
					{{/.isFolder}}
				{{else}}
					<button type="button" class="btn btn-xs btn-danger pull-right" on-click="removeStar" title="Remove Star">
						<span class="glyphicon glyphicon-remove"></span></button>
				{{/if}}
				</td>
			</tr>
			{{/currentFolder.children}}
		</tbody>
	</table>		
	{{/if}}
	</div>	
</div>


<!-- {{>fileTile}} -->
<span>
{{#if .isFolder}}
	<a href="#" on-click="explorerSelect" class="file-tile">
		<span class="grid-icon fa fa-5x fa-{{explorerIcon}}"></span>
		<span class="filename" title="{{#if name.length > 16}}{{name}}{{/if}}">{{name}}</span>
	</a>
{{else}}
	<a href="{{url}}" class="file-tile">
		<span class="grid-icon fa fa-5x fa-{{explorerIcon}}"></span>
		<span class="filename" title="{{#if name.length > 16}}{{name}}{{/if}}">{{name}}</span>
	</a>
{{/if}}
</span>
<!-- {{/fileTile}} -->

</script>
<!--end templates-->

<script src="/core/v1/file/js/jquery-2.1.1.min.js"></script>
<script src="/core/v1/file/js/bootstrap.min.js"></script>
<script src="/core/v1/file/js/ractive.min.js"></script>
<script src="/core/v1/file/js/fh.js"></script>
<script src="/core/v1/file/js/components.js"></script>
<script src="/explorer/v1/file/js/index.js"></script>
<script src="/explorer/v1/file/js/filesize.min.js"></script>
</body>
</html>
